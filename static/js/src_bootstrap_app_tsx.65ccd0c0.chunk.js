(globalThis.webpackChunksenhub=globalThis.webpackChunksenhub||[]).push([["src_bootstrap_app_tsx"],{45597:(e,t,r)=>{"use strict";Object.defineProperty(t,"X$",{value:!0}),Object.defineProperty(t,"jY",{enumerable:!0,get:function(){return a.default}}),t.h0=void 0,Object.defineProperty(t,"ng",{enumerable:!0,get:function(){return n.default}});var i=s(r(70854)),a=s(r(69363)),n=s(r(83272));function s(e){return e&&e.__esModule?e:{default:e}}const o=[i.default];t.h0=o},9120:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Page:()=>se,__esModule:()=>ae.X$,logo:()=>ae.jY,panels:()=>ae.h0,readme:()=>ae.ng});var i=r(55754),a=r(49471),n=r(92950),s=r(50794),o=r(17604),d=r(32671);const c=()=>{const[e,t]=(0,n.useState)(!1);return{loading:e,onWithdraw:(0,n.useCallback)((async e=>{try{t(!0);const r=[],{tx:i}=await window.leFlash.withdrawNFT({chequeAddress:e,sendAndConfirm:!1});r.push(i);const{tx:a}=await window.leFlash.closeCheque({chequeAddress:e,sendAndConfirm:!1});r.push(a),await window.leFlash._provider.sendAll(r.map((e=>({tx:e,signers:[]})))),(0,o.t5)("Withdraw NFT successfully!","")}catch(r){(0,o.cB)(r)}finally{t(!1)}}),[])}};var u=r(7867);u.bs58.encode(s.Wr.accountDiscriminator("distributor")),u.bs58.encode(s.Wr.accountDiscriminator("receipt"));const l={version:"0.1.0",name:"le_flash",instructions:[{name:"initializePool",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"pool",isMut:!0,isSigner:!0},{name:"treasurer",isMut:!1,isSigner:!1},{name:"mintLpt",isMut:!0,isSigner:!0},{name:"associatedTokenAccountLpt",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"associatedTokenProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1}],args:[{name:"mint",type:"publicKey"},{name:"treasury",type:"publicKey"}]},{name:"deposit",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"pool",isMut:!0,isSigner:!1},{name:"cheque",isMut:!0,isSigner:!0},{name:"treasurer",isMut:!1,isSigner:!1},{name:"mintLpt",isMut:!0,isSigner:!1},{name:"associatedTokenAccountLpt",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1},{name:"metadata",isMut:!1,isSigner:!1},{name:"treasury",isMut:!0,isSigner:!1},{name:"srcAssociatedTokenAccount",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"associatedTokenProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1}],args:[{name:"recipient",type:"publicKey"}]},{name:"withdraw",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"pool",isMut:!0,isSigner:!1},{name:"treasurer",isMut:!1,isSigner:!1},{name:"mintLpt",isMut:!0,isSigner:!1},{name:"associatedTokenAccountLpt",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1},{name:"metadata",isMut:!1,isSigner:!1},{name:"treasury",isMut:!0,isSigner:!1},{name:"dstAssociatedTokenAccount",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"associatedTokenProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1}],args:[{name:"amountOut",type:"u64"}]},{name:"withdrawNft",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"pool",isMut:!0,isSigner:!1},{name:"cheque",isMut:!0,isSigner:!1},{name:"treasurer",isMut:!1,isSigner:!1},{name:"mintLpt",isMut:!0,isSigner:!1},{name:"associatedTokenAccountLpt",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1},{name:"metadata",isMut:!1,isSigner:!1},{name:"treasury",isMut:!0,isSigner:!1},{name:"dstAssociatedTokenAccount",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"associatedTokenProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1}],args:[]},{name:"closeCheque",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"cheque",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"initializeDistributor",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"distributor",isMut:!0,isSigner:!0},{name:"src",isMut:!0,isSigner:!1},{name:"treasurer",isMut:!1,isSigner:!1},{name:"treasury",isMut:!0,isSigner:!1},{name:"feeCollector",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"associatedTokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1}],args:[{name:"merkleRoot",type:{array:["u8",32]}},{name:"total",type:"u64"},{name:"endedAt",type:"i64"},{name:"startedAt",type:"i64"},{name:"metadata",type:{array:["u8",32]}},{name:"fee",type:"u64"}]},{name:"claim",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"distributor",isMut:!0,isSigner:!1},{name:"receipt",isMut:!0,isSigner:!1},{name:"dst",isMut:!0,isSigner:!1},{name:"treasurer",isMut:!1,isSigner:!1},{name:"treasury",isMut:!0,isSigner:!1},{name:"feeCollector",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"associatedTokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1}],args:[{name:"proof",type:{vec:{array:["u8",32]}}},{name:"amount",type:"u64"},{name:"startedAt",type:"i64"},{name:"salt",type:{array:["u8",32]}},{name:"fee",type:"u64"},{name:"recipient",type:"publicKey"}]}],accounts:[{name:"cheque",type:{kind:"struct",fields:[{name:"authority",type:"publicKey"},{name:"pool",type:"publicKey"},{name:"mint",type:"publicKey"},{name:"amount",type:"u64"}]}},{name:"distributor",type:{kind:"struct",fields:[{name:"authority",type:"publicKey"},{name:"mint",type:"publicKey"},{name:"merkleRoot",type:{array:["u8",32]}},{name:"total",type:"u64"},{name:"claimed",type:"u64"},{name:"endedAt",type:"i64"},{name:"startedAt",type:"i64"},{name:"metadata",type:{array:["u8",32]}}]}},{name:"pool",type:{kind:"struct",fields:[{name:"authority",type:"publicKey"},{name:"pool",type:"publicKey"},{name:"mint",type:"publicKey"},{name:"treasury",type:"publicKey"},{name:"mintLpt",type:"publicKey"}]}},{name:"receipt",type:{kind:"struct",fields:[{name:"authority",type:"publicKey"},{name:"distributor",type:"publicKey"},{name:"recipient",type:"publicKey"},{name:"startedAt",type:"i64"},{name:"claimedAt",type:"i64"},{name:"salt",type:{array:["u8",32]}}]}}],events:[{name:"CloseChequeEvent",fields:[{name:"authority",type:"publicKey",index:!1},{name:"cheque",type:"publicKey",index:!1},{name:"mint",type:"publicKey",index:!1}]},{name:"DepositEvent",fields:[{name:"authority",type:"publicKey",index:!1},{name:"pool",type:"publicKey",index:!1},{name:"mint",type:"publicKey",index:!1},{name:"cheque",type:"publicKey",index:!1},{name:"amountIn",type:"u64",index:!1},{name:"lptPrintAmount",type:"u64",index:!1}]},{name:"InitializePoolEvent",fields:[{name:"authority",type:"publicKey",index:!1},{name:"pool",type:"publicKey",index:!1},{name:"mint",type:"publicKey",index:!1},{name:"treasury",type:"publicKey",index:!1}]},{name:"ClaimEvent",fields:[{name:"destination",type:"publicKey",index:!1},{name:"recipient",type:"publicKey",index:!1},{name:"startedAt",type:"i64",index:!1},{name:"claimedAt",type:"i64",index:!1},{name:"claimed",type:"u64",index:!1}]},{name:"InitializeDistributorEvent",fields:[{name:"authority",type:"publicKey",index:!1},{name:"distributor",type:"publicKey",index:!1},{name:"merkleRoot",type:{array:["u8",32]},index:!1},{name:"total",type:"u64",index:!1},{name:"endedAt",type:"i64",index:!1},{name:"metadata",type:{array:["u8",32]},index:!1}]},{name:"RevokeEvent",fields:[{name:"authority",type:"publicKey",index:!1},{name:"distributor",type:"publicKey",index:!1},{name:"remaining",type:"u64",index:!1}]},{name:"WithdrawNFTEvent",fields:[{name:"authority",type:"publicKey",index:!1},{name:"pool",type:"publicKey",index:!1},{name:"mint",type:"publicKey",index:!1},{name:"cheque",type:"publicKey",index:!1}]},{name:"WithdrawEvent",fields:[{name:"authority",type:"publicKey",index:!1},{name:"pool",type:"publicKey",index:!1},{name:"mint",type:"publicKey",index:!1},{name:"amountOut",type:"u64",index:!1},{name:"amountLpt",type:"u64",index:!1}]}],errors:[{code:6e3,name:"InvalidNftCollection",msg:"Invalid NFT collection"},{code:6001,name:"NotWithDraw",msg:"NFT has not been retrieved"},{code:6002,name:"Overflow",msg:"Operation overflowed"},{code:6003,name:"InvalidMerkleProof",msg:"Invalid merkle proof"},{code:6004,name:"InvalidCurrentDate",msg:"Cannot get current date"},{code:6005,name:"EndedCampaign",msg:"The campaign has been ended"},{code:6006,name:"NotStartedCampaign",msg:"The campaign is not started yet"},{code:6007,name:"NotEndedCampaign",msg:"The campaign is not ended yet"},{code:6008,name:"NoBump",msg:"Cannot derive the program address"}]},m=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(new s.rV.Keypair).publicKey.toBase58();return{fee:new s.BN(0),feeCollectorAddress:e}};var p=r(16677),h=r(38073),y=r(97429).Buffer;const g=e=>{if(!e)return!1;try{if(!new s.rV.PublicKey(e))throw new Error("Invalid public key");return!0}catch(t){return!1}},w=async e=>await h.O2.metadata.Metadata.getPDA(new s.rV.PublicKey(e)),f=async(e,t,r,i)=>{const[a]=await s.rV.PublicKey.findProgramAddress([y.from("receipt"),e,t.toBuffer(),r.toBuffer()],i);return a};var b=r(59186),A=r(97429).Buffer;const v={rent:s.rV.SYSVAR_RENT_PUBKEY,systemProgram:s.rV.SystemProgram.programId,associatedTokenProgram:s.P6.token.ASSOCIATED_PROGRAM_ID,tokenProgram:b.H_};const P=class{constructor(e,t){var r=this;if(this._provider=void 0,this.program=void 0,this.deriveTreasurerAddress=async e=>{if("string"!==typeof e&&(e=e.toBase58()),!g(e))throw new Error("Invalid pool address");const t=new s.rV.PublicKey(e),[r]=await s.rV.PublicKey.findProgramAddress([A.from("treasurer"),t.toBuffer()],this.program.programId);return r.toBase58()},this.deriveChequeAddress=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!g(e))throw new Error("Invalid proposal address");const i=new s.rV.PublicKey(e),a=r._provider.wallet.publicKey,[n]=await await s.rV.PublicKey.findProgramAddress([A.from("cheque"),i.toBuffer(),a.toBuffer()],r.program.programId),o=n.toBase58();if(t){let t,i;try{const{authority:e,pool:a}=await r.getChequeData(o);t=e.toBase58(),i=a.toBase58()}catch(d){throw new Error(`This cheque ${o} is not initialized yet`)}if(r._provider.wallet.publicKey.toBase58()!==t)throw new Error("Violated authority address");if(e!==i)throw new Error("Violated proposal address")}return o},this.getPoolData=async e=>this.program.account.pool.fetch(e),this.getChequeData=async e=>this.program.account.cheque.fetch(e),this.fetchCheques=async()=>this.program.account.cheque.all(),this.requestUnits=(e,t)=>e.add(p.ComputeBudgetProgram.requestUnits({units:t,additionalFee:0})),this.initializePool=async e=>{let{pool:t=s.rV.Keypair.generate(),mintLpt:r=s.rV.Keypair.generate(),sendAndConfirm:i=!0,mint:a}=e;const n=t,o=n.publicKey.toBase58(),d=await this.deriveTreasurerAddress(o),c=await s.P6.token.associatedAddress({mint:new s.rV.PublicKey(r.publicKey),owner:new s.rV.PublicKey(this._provider.wallet.publicKey)}),u=await s.P6.token.associatedAddress({mint:new s.rV.PublicKey(a),owner:new s.rV.PublicKey(d)}),l=await this.program.methods.initializePool(a,u).accounts({associatedTokenAccountLpt:c,authority:this._provider.wallet.publicKey,mintLpt:r.publicKey,pool:o,treasurer:d,...v}).transaction();let m="";return i&&(this._provider.opts.skipPreflight=!0,m=await this._provider.sendAndConfirm(l,[n,r])),{txId:m,poolAddress:n.publicKey.toBase58(),tx:l}},this.deposit=async e=>{let{recipient:t=this._provider.wallet.publicKey.toBase58(),poolAddress:r,sendAndConfirm:i=!0,mintNFTAddress:a,chequeKeypair:n=s.rV.Keypair.generate()}=e;const o=new s.rV.PublicKey(t),{mintLpt:d}=await this.getPoolData(r),c=await this.deriveTreasurerAddress(r),u=(await w(new s.rV.PublicKey(a))).toBase58(),l=await s.P6.token.associatedAddress({mint:d,owner:new s.rV.PublicKey(this._provider.wallet.publicKey)}),m=await s.P6.token.associatedAddress({mint:new s.rV.PublicKey(a),owner:new s.rV.PublicKey(this._provider.wallet.publicKey)}),p=await s.P6.token.associatedAddress({mint:new s.rV.PublicKey(a),owner:new s.rV.PublicKey(c)}),h=n.publicKey.toBase58();let y=await this.program.methods.deposit(o).accounts({authority:this._provider.wallet.publicKey,pool:r,associatedTokenAccountLpt:l,mint:a,mintLpt:d,srcAssociatedTokenAccount:m,treasurer:c,treasury:p,cheque:h,metadata:u,...v}).transaction(),g="";return i&&(this._provider.opts.skipPreflight=!0,g=await this._provider.sendAndConfirm(y,[n])),{txId:g,tx:y,chequeAddress:n.publicKey.toBase58()}},this.withdraw=async e=>{let{amount:t,poolAddress:r,sendAndConfirm:i=!0}=e;const{mint:a,mintLpt:n}=await this.getPoolData(r),o=await this.deriveTreasurerAddress(r),d=(await w(new s.rV.PublicKey(a))).toBase58(),c=await s.P6.token.associatedAddress({mint:n,owner:new s.rV.PublicKey(this._provider.wallet.publicKey)}),u=await s.P6.token.associatedAddress({mint:a,owner:new s.rV.PublicKey(this._provider.wallet.publicKey)}),l=await s.P6.token.associatedAddress({mint:new s.rV.PublicKey(a),owner:new s.rV.PublicKey(o)});let m=await this.program.methods.withdraw(t).accounts({authority:this._provider.wallet.publicKey,pool:r,associatedTokenAccountLpt:c,mint:a,mintLpt:n,dstAssociatedTokenAccount:u,treasurer:o,treasury:l,metadata:d,...v}).transaction(),p="";return i&&(p=await this._provider.sendAndConfirm(m,[])),{txId:p,tx:m}},this.withdrawNFT=async e=>{let{chequeAddress:t,sendAndConfirm:r=!0}=e;const{pool:i,mint:a}=await this.getChequeData(t),{mintLpt:n}=await this.getPoolData(i),o=await this.deriveTreasurerAddress(i),d=(await w(new s.rV.PublicKey(a))).toBase58(),c=await s.P6.token.associatedAddress({mint:n,owner:new s.rV.PublicKey(this._provider.wallet.publicKey)}),u=await s.P6.token.associatedAddress({mint:a,owner:new s.rV.PublicKey(this._provider.wallet.publicKey)}),l=await s.P6.token.associatedAddress({mint:new s.rV.PublicKey(a),owner:new s.rV.PublicKey(o)});let m=await this.program.methods.withdrawNft().accounts({authority:this._provider.wallet.publicKey,pool:i,associatedTokenAccountLpt:c,mint:a,mintLpt:n,dstAssociatedTokenAccount:u,treasurer:o,treasury:l,metadata:d,cheque:t,...v}).transaction(),p="";return r&&(p=await this._provider.sendAndConfirm(m,[])),{txId:p,tx:m}},this.closeCheque=async e=>{let{chequeAddress:t,sendAndConfirm:r=!0}=e;const i=new s.rV.PublicKey(t),a=await this.program.methods.closeCheque().accounts({authority:this._provider.wallet.publicKey,cheque:i,...v}).transaction();let n="";return console.log(a,"tx"),r&&(n=await this._provider.sendAndConfirm(a,[])),{txId:n,tx:a}},!g(t))throw new Error("Invalid program id");this._provider=e,this.program=new s.$r(l,t,this._provider)}};var K=r(16348),S=r(97429).Buffer;const k=104;class M{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.receipients=void 0,this.leafs=void 0,this.getTotal=()=>new s.BN(this.receipients.length),this.toBuffer=()=>S.concat(this.receipients.map(M.serialize)),this.getLeaf=e=>{const t=M.serialize(e);return S.from(K.keccak_256.digest(t))},this.getParent=(e,t)=>{if(!e||!t)throw new Error("Invalid child");const r=S.concat(M.sort(e,t));return S.from(K.keccak_256.digest(r))},this.getSibling=(e,t)=>{const r=t.findIndex((t=>0===t.compare(e)));if(-1===r)throw new Error("Invalid child");return r%2===1?t[r-1]:t[r+1]},this.nextLayer=e=>{const t=[...e];if(0===t.length)throw new Error("Invalid tree");if(1===t.length)return t;const r=t.length%2===1?t.pop():void 0,i=[];for(let a=0;a<t.length;a+=2)i.push(this.getParent(t[a],t[a+1]));return r?[...i,r]:i},this.deriveMerkleRoot=()=>{let e=this.leafs;for(;e.length>1;)e=this.nextLayer(e);return e[0]},this.deriveProof=e=>{let t=this.getLeaf(e);const r=[];let i=this.leafs;for(;i.length>1;){const e=this.getSibling(t,i);e&&(t=this.getParent(t,e),r.push(e)),i=this.nextLayer(i)}return r},this.verifyProof=(e,t)=>{let r=this.getLeaf(t);for(const i of e)r=this.getParent(r,i);return 0===this.deriveMerkleRoot().compare(r)},this.receipients=e,this.leafs=M.sort(...this.receipients.map((e=>this.getLeaf(e))))}}M.sort=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return[...t].sort(((e,t)=>{const r=S.compare(e,t);if(0===r)throw new Error("The receipients has a duplication");return r}))},M.serialize=e=>{let{authority:t,chequeAddress:r,startedAt:i,salt:a}=e;return S.concat([t.toBuffer(),r.toBuffer(),i.toArrayLike(S,"le",8),a])},M.deserialize=e=>{if(e.length!==k)throw new Error("Invalid buffer");return{authority:new s.rV.PublicKey(e.subarray(0,32)),chequeAddress:new s.rV.PublicKey(e.subarray(32,64)),startedAt:new s.BN(e.subarray(64,72),"le"),salt:S.from(e.subarray(72,104))}},M.salt=e=>{let t="";for(;t.length<128;)t+=Math.round(10*Math.random()).toString();const r=e||t;return S.from(K.keccak_256.digest(r))},M.fromBuffer=e=>{if(e.length%k!==0)throw new Error("Invalid buffer");let t=[];for(let r=0;r<e.length;r+=k)t.push(M.deserialize(e.subarray(r,r+k)));return new M(t)};var x=r(97429).Buffer;class B{constructor(e,t){var r=this;if(this._provider=void 0,this.program=void 0,this.removeListener=async e=>{try{await this.program.removeEventListener(e)}catch(t){console.warn(t)}},this.getCurrentUnixTimestamp=async()=>{const{data:e}=await this.program.provider.connection.getAccountInfo(s.rV.SYSVAR_CLOCK_PUBKEY)||{};if(!e)throw new Error("Cannot fetch clock data");return new s.BN(e.subarray(32,40),"le").toNumber()},this.parseDistributorData=e=>this.program.coder.accounts.decode("distributor",e),this.getDistributorData=async e=>this.program.account.distributor.fetch(e),this.parseReceiptData=e=>this.program.coder.accounts.decode("receipt",e),this.getReceiptData=async e=>this.program.account.receipt.fetch(e),this.deriveReceiptAddress=async function(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(32!==e.length)throw new Error("The salt must has length 32");if(!g(t))throw new Error("Invalid distributor address");const a=await f(e,new s.rV.PublicKey(t),r._provider.wallet.publicKey,r.program.programId),n=a.toBase58();if(i){let i,a,s;try{const{authority:e,distributor:t,salt:o}=await r.getReceiptData(n);i=e.toBase58(),a=t.toBase58(),s=x.from(o)}catch(o){throw new Error(`This receipt ${n} is not initialized yet`)}if(r._provider.wallet.publicKey.toBase58()!==i)throw new Error("Violated authority address");if(t!==a)throw new Error("Violated proposal address");if(0!==e.compare(s))throw new Error("Violated salt")}return n},this.deriveTreasurerAddress=async e=>{if(!g(e))throw new Error("Invalid distributor address");const t=new s.rV.PublicKey(e),[r]=await s.rV.PublicKey.findProgramAddress([x.from("treasurer"),t.toBuffer()],this.program.programId);return r.toBase58()},this.initializeDistributor=async e=>{let{tokenAddress:t,total:r,merkleRoot:i,metadata:a,startedAt:n=0,endedAt:o=0,distributor:d=s.rV.Keypair.generate(),feeOptions:c=m(this._provider.wallet.publicKey.toBase58()),sendAndConfirm:u=!0}=e;const{fee:l,feeCollectorAddress:p}=c;if(!g(p))throw new Error("Invalid fee collector address");if(!g(t))throw new Error("Invalid token address");if(!(h=i)||32!==h.length)throw new Error("Invalid merkle root");var h;if(r.isNeg())throw new Error("The total must not be negative");if(32!==a.length)throw new Error("Invalid metadata path");const y=d.publicKey.toBase58(),w=new s.rV.PublicKey(t),f=await s.P6.token.associatedAddress({mint:w,owner:this._provider.wallet.publicKey}),b=await this.deriveTreasurerAddress(y),A=new s.rV.PublicKey(b),v=await s.P6.token.associatedAddress({mint:w,owner:A}),P=this.program.methods.initializeDistributor([...i],r,new s.BN(o),new s.BN(n),[...a],l).accounts({authority:this._provider.wallet.publicKey,distributor:d.publicKey,src:f,treasurer:A,treasury:v,feeCollector:new s.rV.PublicKey(p),mint:w,tokenProgram:s.P6.token.TOKEN_PROGRAM_ID,associatedTokenProgram:s.P6.token.ASSOCIATED_PROGRAM_ID,systemProgram:s.rV.SystemProgram.programId,rent:s.rV.SYSVAR_RENT_PUBKEY}).signers([d]);return{tx:await P.transaction(),txId:u?await P.rpc({commitment:"confirmed"}):"",distributorAddress:y}},this.claim=async e=>{let{distributorAddress:t,proof:r,data:i,feeOptions:a=m(this._provider.wallet.publicKey.toBase58()),sendAndConfirm:n=!0}=e;const{fee:o,feeCollectorAddress:d}=a;if(!g(d))throw new Error("Invalid fee collector address");if(!g(t))throw new Error("Invalid distributor address");if(!this._provider.wallet.publicKey.equals(i.authority))throw new Error("Invalid athority address");const{mint:c}=await this.getDistributorData(t),u=await this.deriveReceiptAddress(i.salt,t),l=await s.P6.token.associatedAddress({mint:c,owner:this._provider.wallet.publicKey}),p=await this.deriveTreasurerAddress(t),h=new s.rV.PublicKey(p),y=await s.P6.token.associatedAddress({mint:c,owner:h}),w=await this.program.methods.claim(r.map((e=>e.toJSON().data)),new s.BN(1),i.startedAt,i.salt.toJSON().data,o,i.chequeAddress).accounts({authority:this._provider.wallet.publicKey,distributor:new s.rV.PublicKey(t),receipt:new s.rV.PublicKey(u),dst:l,treasurer:h,treasury:y,feeCollector:new s.rV.PublicKey(d),mint:c,tokenProgram:s.P6.token.TOKEN_PROGRAM_ID,associatedTokenProgram:s.P6.token.ASSOCIATED_PROGRAM_ID,systemProgram:s.rV.SystemProgram.programId,rent:s.rV.SYSVAR_RENT_PUBKEY});return{tx:await w.transaction(),txId:n?await w.rpc({commitment:"confirmed"}):"",dstAddress:l.toBase58()}},!g(t))throw new Error("Invalid program id");this._provider=e,this.program=new s.$r(l,t,this._provider)}get events(){return this.program.idl.events.map((e=>{let{name:t}=e;return t}))}}var C=r(21995),E=r.n(C);const V={appId:"senhub",url:"https://descartesnetwork.github.io/senhub/index.js"},_={devnet:{node:"https://api.devnet.solana.com",leFlashId:"3E8eFwLQhHgtzqAnestzG7SeZUWYH7BZLf8m9EGa8wJH"},testnet:{node:"https://api.testnet.solana.com",leFlashId:"3E8eFwLQhHgtzqAnestzG7SeZUWYH7BZLf8m9EGa8wJH"},mainnet:{node:"https://api.mainnet-beta.solana.com",leFlashId:"3E8eFwLQhHgtzqAnestzG7SeZUWYH7BZLf8m9EGa8wJH"}},T={development:{senApiUpload:"https://api.sentre.io/storage/upload",aws:"https://sen-storage.s3.us-west-2.amazonaws.com/"},production:{senApiUpload:"https://api.sentre.io/storage/upload",aws:"https://sen-storage.s3.us-west-2.amazonaws.com/"}},I={manifest:{development:{...V},production:{...V}}[a.env],sol:_[a.net],api:T[a.env]};var q=r(4065);const D=()=>{const e=(0,a.useWalletAddress)();return(0,n.useMemo)((()=>{const t=(0,q.getAnchorProvider)(a.rpc,e,window.sentre.solana);return new B(t,I.sol.leFlashId)}),[e])};var L=r(97429).Buffer;const N=L.from("00","hex"),R=e=>{const t=(e=>{const t=u.bs58.decode(e);let r=L.from(t.subarray(28,32)).toString("utf8");for(;r[0]===N.toString("utf8");)r=r.substring(1);return r})(e),r=L.from(u.bs58.decode(e).subarray(0,28));return`${u.bs58.encode(r)}.${t}`};var F=r(97429).Buffer;var z=r(45263),O=r(97429).Buffer;const j="9GNAW8gpiatCFHryfF5XyhXP3wKXLb9Kqd3zgdn8y43M",W=()=>{const[e,t]=(0,n.useState)(!1),[r,i]=(0,n.useState)(),{onWithdraw:s}=c(),l=(0,n.useCallback)((async e=>{const{metadata:t}=e,r=u.bs58.encode(F.from(t)),i=R(r),a=I.api.aws+i,{data:n}=await E().get(a);return{data:n.data}}),[]),m=(0,a.useWalletAddress)(),p=D(),h=(0,n.useCallback)((async()=>{try{const e=await p.getDistributorData(j);console.log(e);const{data:{data:t}}=await l(e),r=M.fromBuffer(O.from(t));return i(r)}catch(e){(0,o.cB)(e)}}),[l,p]),y=(0,n.useMemo)((()=>{if(!r)return;const e=r.receipients;for(const t of e)if(m===t.authority.toBase58())return t}),[r,m]);return(0,n.useEffect)((()=>{h()}),[h]),(0,z.jsx)(d.Row,{gutter:[24,24],justify:"center",className:"lightning-container",children:(0,z.jsx)(d.Button,{type:"primary",onClick:async()=>{if(!y||!r)return;const e=r.deriveProof(y);if(r.verifyProof(e,y))try{t(!0),await p.claim({distributorAddress:j,proof:e,data:y}),console.log(y.chequeAddress.toBase58()),await s(y.chequeAddress.toBase58())}catch(i){(0,o.cB)(i)}finally{t(!1)}},loading:e,children:"Redeem"})})},Y=[{mintNft:"HR8NVufX46rhAWU6tUm4QmyB77BUwbN6HAxVWgpE3dEm"}],U=[{walletAddress:"2vAEiACep3J1N2J6YY9gt4gAbbFEvuVdWgyu8KUkgzgn",chequeAddress:"CtgycWabAnLB7PYXQdhPp3FuuJqcwiCCGxvFWbsPmzyg",unlockTime:0}],G=()=>{const[e,t]=(0,n.useState)("8YD4Mi1B7huwJgjaipwLrTCr3rvq5DvDsRUmxqhowD2r"),{onDeposit:r,loading:i}=(()=>{const[e,t]=(0,n.useState)(!1),r=(0,n.useCallback)((async(e,r)=>{try{t(!0);let i=[];for(const{address:t,mintNft:a}of e){const e=s.rV.Keypair.generate(),{tx:n,chequeAddress:o}=await window.leFlash.deposit({recipient:t,mintNFTAddress:a,sendAndConfirm:!1,poolAddress:r,chequeKeypair:e});i.push({tx:n,signers:[e]}),console.log("chequeAddress: ",o)}return await window.leFlash._provider.sendAll(i.map((e=>{let{tx:t,signers:r}=e;return{tx:t,signers:r}}))),(0,o.t5)("Deposited successfully!","txId")}catch(i){(0,o.cB)(i)}finally{t(!1)}}),[]);return{onDeposit:r,loading:e}})(),{loading:a,onWithdraw:l}=c(),m=D(),[p,h]=(0,n.useState)("ENc9uK6z1sGLdp6iN2er32Aatxg6Cxr1TaY4FRJeP4pE"),[y,g]=(0,n.useState)(!1),w=(0,n.useCallback)((async e=>{const t=new FormData;t.append("file",e);const{data:r}=await E().post(I.api.senApiUpload,t,{headers:{"Content-Type":"multipart/form-data"},withCredentials:!0});return r.cid}),[]),f=(0,n.useMemo)((()=>{const e=U.map(((e,t)=>{let{chequeAddress:r,unlockTime:i,walletAddress:a}=e;return{authority:new s.rV.PublicKey(a),chequeAddress:new s.rV.PublicKey(r),startedAt:new s.BN(i/1e3),salt:M.salt(`le-flash/${t.toString()}`)}})),t=new M(e).toBuffer();return console.log(t),t}),[]);return(0,z.jsx)(d.Row,{children:(0,z.jsxs)(d.Col,{span:12,children:[(0,z.jsx)(d.Button,{loading:i,disabled:!p,onClick:()=>r(Y,p),children:"Deposit"}),(0,z.jsx)(d.Button,{loading:y,onClick:async()=>{try{g(!0);const{poolAddress:e,txId:t}=await window.leFlash.initializePool({mint:new s.rV.PublicKey("PV64GFvXc9vNWWvQs9XAxGYjy9xzACHw9yAJhAypeVe")});h(e),console.log(e),(0,o.t5)("Initialized Pool successfully!",t)}catch(e){(0,o.cB)(e)}finally{g(!1)}},children:"Init Pool"}),(0,z.jsx)(d.Button,{loading:a,onClick:()=>l("G7Q73K3cL2eQQrp7KcZw3hEboZb2Zmr2Lb7p6wNNiwdF"),children:"Withdraw"}),(0,z.jsx)(d.Button,{loading:y,onClick:async()=>{const{mintLpt:e}=await window.leFlash.getPoolData(p);return console.log("mintLpt: ",e.toBase58()),t(e.toBase58())},children:"getMint"}),(0,z.jsx)(d.Button,{loading:y,onClick:async()=>{try{if(!f)throw new Error("Invalid Merkle Data");g(!0),console.log("dataBuffer");const t=M.fromBuffer(f),r={checked:!1,createAt:Math.floor(Date.now()/1e3),data:f},i=[new Blob([JSON.stringify({data:r},null,2)],{type:"application/json"})],a=new File(i,"metadata.txt"),n=await w(a),s=u.bs58.decode(n),{txId:d,distributorAddress:c}=await m.initializeDistributor({tokenAddress:e,total:t.getTotal(),merkleRoot:t.deriveMerkleRoot(),metadata:s,endedAt:0});console.log(c),(0,o.t5)("Airdrop",d)}catch(t){window.notify({type:"error",description:t.message})}finally{g(!1)}},children:"init distributor"}),(0,z.jsx)(W,{})]})})};var H=r(19289),J=r(48744),Q=r.n(J),X=r(97429).Buffer;BigInt.prototype.toJSON=function(){return this.toString()};const Z={serializableCheck:{isSerializable:e=>"undefined"===typeof e||null===e||"string"===typeof e||"boolean"===typeof e||"number"===typeof e||Array.isArray(e)||(e=>{if(null===e)return!1;const t=Object.getPrototypeOf(e);return null!==t&&null===Object.getPrototypeOf(t)})(e)||"bigint"===typeof e||e instanceof p.PublicKey||e instanceof Q()||X.isBuffer(e)}},$="main",ee=(0,H.createAsyncThunk)("main/increaseCounter",(async(e,t)=>{let{getState:r}=t;const{main:{counter:i}}=r();return{counter:i+1}})),te=(0,H.createSlice)({name:$,initialState:{counter:0},reducers:{},extraReducers:e=>{e.addCase(ee.fulfilled,((e,t)=>{let{payload:r}=t;Object.assign(e,r)}))}}).reducer,re=(0,H.configureStore)({middleware:e=>e(Z),devTools:!1,reducer:{main:te}}),ie=e=>{let{children:t}=e;const r=(0,a.useWalletAddress)(),[i,s]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{if(i)return;const e=(0,q.getAnchorProvider)(a.rpc,r,window.sentre.solana),t=new P(e,I.sol.leFlashId);window.leFlash=t,s(!0)}),[r,i]),i?(0,z.jsx)(n.Fragment,{children:t}):null};var ae=r(45597);const{manifest:{appId:ne}}=I,se=()=>(0,z.jsx)(a.AntdProvider,{appId:ne,children:(0,z.jsx)(i.Provider,{store:re,children:(0,z.jsx)(ie,{children:(0,z.jsx)(G,{})})})})},83272:(e,t,r)=>{"use strict";e.exports=r.p+"static/media/README.ff93448fef94ea73029b.md"},69363:(e,t,r)=>{"use strict";e.exports=r.p+"static/media/logo.da175f6d5d1564b6bc58.png"},70854:(e,t,r)=>{"use strict";e.exports=r.p+"static/media/panel.6ce7bc345912340df001.png"},7420:()=>{},95856:()=>{},46601:()=>{}}]);
//# sourceMappingURL=src_bootstrap_app_tsx.65ccd0c0.chunk.js.map